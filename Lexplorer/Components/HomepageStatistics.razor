@using GraphQL
@using Lexplorer.Models
@inject Lexplorer.Services.GraphQLService GraphQLService;
@if(blockData != null)
{
    <MudGrid>
        <MudItem xs="4">
            <MudCard>
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Total Transactions</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">TO DO</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="4">
            <MudCard>
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Total Blocks</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">@blockData.data.proxy.blockCount</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="4">
            <MudCard>
               <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Total L2 Accounts</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">@blockData.data.proxy.userCount</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>
    <MudGrid>
        <MudItem xs="4">
            <MudCard>
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Average Block Time</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">TO DO</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="4">
            <MudCard>
                <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Average Transactions per Block</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">TO DO</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
        <MudItem xs="4">
            <MudCard>
               <MudCardContent>
                    <MudText Typo="Typo.h6" Align="Align.Center">Last Block Submitted</MudText>
                    <MudText Typo="Typo.body1" Align="Align.Center">TO DO</MudText>
                </MudCardContent>
            </MudCard>
        </MudItem>
    </MudGrid>
    <MudText Typo="Typo.h6">Latest Blocks</MudText>
    <MudTable Items="@blockData.data.blocks" Hover="true">
        <HeaderContent>
            <MudTh>Block ID</MudTh>
            <MudTh>L1 Transaction Hash</MudTh>
            <MudTh>Block Size</MudTh>
            <MudTh>Time</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Block Id">@context.id</MudTd>
            <MudTd DataLabel="Block Id"><a Class="mud-theme-primary" href="https://etherscan.io/tx/@context.txHash" target="_blank">@context.txHash</a></MudTd>
            <MudTd DataLabel="Block Id">@context.blockSize</MudTd>
            <MudTd DataLabel="Block Id">@context.timestamp</MudTd>
        </RowTemplate>
    </MudTable>
}
else
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true"/>
}

@code 
{
    private BlockData blockData;
    protected override async Task OnInitializedAsync()
    {
       blockData = await GraphQLService.GetBlocks();
    }
}
